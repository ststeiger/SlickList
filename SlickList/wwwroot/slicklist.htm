<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta charset="utf-8" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

    <meta http-equiv="cache-control" content="max-age=0" />
    <meta http-equiv="cache-control" content="no-cache" />
    <meta http-equiv="expires" content="0" />
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
    <meta http-equiv="pragma" content="no-cache" />


    <title>Slicklist-Beispiel</title>

    <link rel="stylesheet" type="text/css" href="../w8/Layout.ashx?Single=COR_Resources:COR.Dialogue.css" />
    <link rel="stylesheet" type="text/css" href="../w8/Layout.ashx?Single=COR_Resources:COR.Resources.css" />
    <link rel="stylesheet" type="text/css" href="../w8/Layout.ashx?Single=COR_Resources:SlickGrid/slick.grid.css" />

    <!--
        <link rel = "stylesheet" type = "text/css" href="../w8/Layout.ashx?Single=COR_Resources:SlickGrid/slick.grid.cor.css" />
    -->

    <style>
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
            width: 100%
        }

        body {
            background: #1e90ff
        }
    </style>

    <script type="text/javascript" src="../w8/Script.ashx?Single=turnJS.jquery-1.7.2.min.js"></script>
    <script type="text/javascript" src="../w8/Script.ashx?Single=Portal.Debug.js"></script>
    <script type="text/javascript" src="../w8/Script.ashx?Single=Portal.AJAX.js"></script>
    <script type="text/javascript" src="../w8/Script.ashx?Single=Portal.Waiting.js"></script>
    <script type="text/javascript" src="../w8/Script.ashx?Single=COR_Resources:COR.QueryString.js"></script>
    <script type="text/javascript" src="../w8/Script.ashx?Single=COR_Resources:COR.Element.js"></script>
    <script type="text/javascript" src="../w8/Script.ashx?Single=COR_Resources:COR.Dialogue.js"></script>
    <script type="text/javascript" src="../w8/Script.ashx?Single=COR_Resources:SlickGrid/jquery-ui.osrtable.min.js"></script>
    <script type="text/javascript" src="../w8/Script.ashx?Single=COR_Resources:SlickGrid/jquery.event.drag-2.0.min.js"></script>
    <script type="text/javascript" src="../w8/Script.ashx?Single=COR_Resources:SlickGrid/slick.core.js"></script>
    <script type="text/javascript" src="../w8/Script.ashx?Single=COR_Resources:SlickGrid/slick.grid.js"></script>
    <script type="text/javascript" src="../w8/Script.ashx?Single=COR_Resources:SlickGrid/slick.checkboxselectcolumn.js"></script>
    <script type="text/javascript" src="../w8/Script.ashx?Single=COR_Resources:SlickGrid/slick.rowselectionmodel.js"></script>
    <script type="text/javascript" src="../w8/Script.ashx?Single=COR_Resources:SlickGrid/slick.autotooltips.js"></script>
    <script type="text/javascript" src="../w8/Script.ashx?Single=COR_Resources:SlickGrid/slick.dataview.js"></script>
    <script type="text/javascript" src="../w8/Script.ashx?Single=COR_Resources:SlickGrid/slick.columnpicker.js"></script>
    <script type="text/javascript" src="../w8/Script.ashx?Single=COR_Resources:Slicklist/COR.Slicklist.js"></script>
    <script type="text/javascript" src="../w8/Script.ashx?Single=COR_Resources:Slicklist/COR.Slicklist.Footer.js"></script>
    <script type="text/javascript" src="../w8/Script.ashx?Single=COR_Resources:Slicklist/COR.Slicklist.Formatter.js"></script>
    <script type="text/javascript" src="../w8/Script.ashx?Single=COR_Resources:Slicklist/COR.Slicklist.Sorter.js"></script>
    <script type="text/javascript" src="../w8/Script.ashx?Single=COR_Resources:Slicklist/COR.Slicklist.Editor.js"></script>
    <script type="text/javascript" src="../w8/Script.ashx?Single=COR_Resources:Libs/Export.fabric.min.js"></script>
    <script type="text/javascript" src="../w8/Script.ashx?Single=COR_Resources:Libs/Export.FileSaver.min.js"></script>
    <script type="text/javascript" src="../w8/Script.ashx?Single=COR_Resources:Libs/Export.pdfmake.min.js"></script>
    <script type="text/javascript" src="../w8/Script.ashx?Single=COR_Resources:Libs/Export.vfs_fonts.min.js"></script>
    <script type="text/javascript" src="../w8/Script.ashx?Single=COR_Resources:Libs/Export.jszip.min.js"></script>
    <script type="text/javascript" src="../w8/Script.ashx?Single=COR_Resources:Libs/Export.xlsx.min.js"></script>
    <script type="text/javascript" src="../w8/Script.ashx?Single=COR_Resources:Slicklist/COR.Slicklist.Export.js"></script>

    <script>
        ; window.onload = function ()
        {
            _.Slicklist.AJAX = function () { return Portal.AJAX };

            var tL = ('Slicklist.ashx?SL_UID=@SL_UID.&Time=@Time.')
                .replace('@SL_UID.', '2112D5DD-EB63-446F-AF64-4C1AEB0A9289')
                .replace('@Time.', +new Date);

            var tFilter = { Text: '', SK: '', ORT: '', SO: '', GB: '', TK: '', GS: '', RM: '', OBJT: '', OBJT_KAT: '', OBJ: '', BE: 0, DatumTicks: +new Date };

            if (!window.Slicklist)
            {
                window.Slicklist = _.Slicklist.Add({
                    container: document.body,
                    globalPath: '../',
                    link: tL,
                    postValues: "Text=&SK=&ORT=&SO=&GB=&TK=&GS=&RM=&DatumTicks=",

                    onContentLoadingBegin: function (slicklist) { Portal.Waiting.Start(slicklist.container) },
                    onContentLoadingEnd: function (slicklist) { Portal.Waiting.Stop(slicklist.container) },

                    onRowAperture: function (data, param)
                    {
                        if (param && param.aperturepath)
                        {
                            Basic.Waiting.Start();

                            var tL = '../' + param.aperturepath
                                .replace('@Time.', +new Date)
                                .replace('@Code.', data.OBJ_OBJT_Code || param.OBJ_OBJT_Code)
                                .replace('@ObjID.', data.OBJ_ApertureObjID || data.OBJ_ParentApertureObjID)

                            Basic.AJAX.getEval(tL, function (r, data)
                            {
                                _That.openAsIframe(
                                    r,
                                    _getDialogueTitle(data, param),
                                    [{ Name: 'Schliessen', Styles: { float: 'right' } }])
                            }, data);
                        }
                    },

                    onRowEdit: function (data, param)
                    {
                        if (param && param.editpath)
                        {
                            Basic.Waiting.Start();
                            _That.openAsIframe(
                                _replaceValues('../' + param.editpath, data),
                                _getDialogueTitle(data, param)
                            )
                        }
                    },

                    onRowSVGLink: function (data, param)
                    {
                        Basic.Waiting.Start();

                        var tLink = 'data/data.ashx?Time=@Time.&SQL=OM_getSVGLinkFromOBJ.sql&OBJ=@OBJ.&Datum=@Datum.'
                            .replace('@Time.', +new Date)
                            .replace('@OBJ.', data.id)
                            .replace('@Datum.', '');

                        Basic.AJAX.getEval(tLink, function (r, title)
                        {
                            if (r && r.length)
                            {
                                var tSettings = _That.getPortalSettings();

                                _That.openAsIframe(
                                    (tSettings ? tSettings.portalLink : '') + r[0].SVGLink,
                                    title || '-',
                                    [{ Name: 'Schliessen', Styles: { float: 'right' } }]
                                )
                            }
                        }, _getDialogueTitle(data, param))
                    }
                })
            }
            else
            {
                _.Slicklist.Reload(window.Slicklist, tL);
                _.Slicklist.onResize(500)
            }
        };
    </script>
</head>

	<body>

	</body>
</html>